{"ast":null,"code":"/** PURE_IMPORTS_START _Observable,_util_identity,_util_isScheduler PURE_IMPORTS_END */\nimport { Observable } from '../Observable';\nimport { identity } from '../util/identity';\nimport { isScheduler } from '../util/isScheduler';\nexport function generate(initialStateOrOptions, condition, iterate, resultSelectorOrObservable, scheduler) {\n  var resultSelector;\n  var initialState;\n\n  if (arguments.length == 1) {\n    var options = initialStateOrOptions;\n    initialState = options.initialState;\n    condition = options.condition;\n    iterate = options.iterate;\n    resultSelector = options.resultSelector || identity;\n    scheduler = options.scheduler;\n  } else if (resultSelectorOrObservable === undefined || isScheduler(resultSelectorOrObservable)) {\n    initialState = initialStateOrOptions;\n    resultSelector = identity;\n    scheduler = resultSelectorOrObservable;\n  } else {\n    initialState = initialStateOrOptions;\n    resultSelector = resultSelectorOrObservable;\n  }\n\n  return new Observable(function (subscriber) {\n    var state = initialState;\n\n    if (scheduler) {\n      return scheduler.schedule(dispatch, 0, {\n        subscriber: subscriber,\n        iterate: iterate,\n        condition: condition,\n        resultSelector: resultSelector,\n        state: state\n      });\n    }\n\n    do {\n      if (condition) {\n        var conditionResult = void 0;\n\n        try {\n          conditionResult = condition(state);\n        } catch (err) {\n          subscriber.error(err);\n          return undefined;\n        }\n\n        if (!conditionResult) {\n          subscriber.complete();\n          break;\n        }\n      }\n\n      var value = void 0;\n\n      try {\n        value = resultSelector(state);\n      } catch (err) {\n        subscriber.error(err);\n        return undefined;\n      }\n\n      subscriber.next(value);\n\n      if (subscriber.closed) {\n        break;\n      }\n\n      try {\n        state = iterate(state);\n      } catch (err) {\n        subscriber.error(err);\n        return undefined;\n      }\n    } while (true);\n\n    return undefined;\n  });\n}\n\nfunction dispatch(state) {\n  var subscriber = state.subscriber,\n      condition = state.condition;\n\n  if (subscriber.closed) {\n    return undefined;\n  }\n\n  if (state.needIterate) {\n    try {\n      state.state = state.iterate(state.state);\n    } catch (err) {\n      subscriber.error(err);\n      return undefined;\n    }\n  } else {\n    state.needIterate = true;\n  }\n\n  if (condition) {\n    var conditionResult = void 0;\n\n    try {\n      conditionResult = condition(state.state);\n    } catch (err) {\n      subscriber.error(err);\n      return undefined;\n    }\n\n    if (!conditionResult) {\n      subscriber.complete();\n      return undefined;\n    }\n\n    if (subscriber.closed) {\n      return undefined;\n    }\n  }\n\n  var value;\n\n  try {\n    value = state.resultSelector(state.state);\n  } catch (err) {\n    subscriber.error(err);\n    return undefined;\n  }\n\n  if (subscriber.closed) {\n    return undefined;\n  }\n\n  subscriber.next(value);\n\n  if (subscriber.closed) {\n    return undefined;\n  }\n\n  return this.schedule(state);\n}","map":{"version":3,"mappings":"AAAA;AAEA,SAASA,UAAT,QAAyB,eAAzB;AAEA,SAASC,QAAT,QAAsB,kBAAtB;AA8PA,SAAMC,WAAN,QAA+B,qBAA/B;OAME,SAAIC,QAAJ,CAAqCC,qBAArC,EAAqCC,SAArC,EAAqCC,OAArC,EAAqCC,0BAArC,EAAqCC,SAArC,EAAqC;AACrC,MAAIC,cAAJ;AAEA,MAAIC,YAAJ;;MACEC,SAAM,OAAN,IAAgB;AAChB,kBAAYP,qBAAZ;AACAM,gBAAY,UAAQ,aAApB;AACAL,aAAO,GAAGO,OAAQ,UAAlB;AACAN,qBAAiB,QAAjB;AACAG,kBAAY,UAAQ,eAAR,IAAkBR,QAA9B;AACDO;SACC,8BAAe,KAA0BK,SAAzC,IAA0CX,uCAA1C,EAA0C;AAC1CQ,mBAAcN,qBAAd;AACAK,kBAAY,WAAZ;AACDD;GAHC,MAIA;AACAE,mBAAcN,qBAAd;AACDK;AAED;;SACE,IAAIT,UAAJ,CAAY,UAAac,UAAb,EAAa;AACzB,QAAIC,oBAAJ;;QACEP,WAAO;aACLA,SAAU,SAAV,CAAUQ,QAAV,EAAU,CAAV,EAAU;AACVF,kBAAO,YADG;AAEVR,iBAASA,OAFC;AAGVD,4BAHU;AAIVI,sBAAK,gBAJK;AAKTM;AALS,OAAV;AAQJ;;;UAEIV,WAAI;AACJ,YAAIY,wBAAJ;;YACE;AACDA;AAAC,iBACAC;AACAJ,oBAAO,MAAP,CAAiBI,GAAjB;AACD;AACD;;YACE,kBAAW;AACXJ,oBAAM,SAAN;AACD;AACF;AACD;;AACA,UAAIK,cAAJ;;UACE;AACDA;AAAC,eACAD;AACAJ,kBAAO,MAAP,CAAiBI,GAAjB;AACD;AACD;;AACAJ,gBAAI,KAAJ,CAAeK,KAAf;;UACEL,UAAM;AACP;AACD;;UACE;AACDC;AAAC,eACAG;AACAJ,kBAAO,MAAP,CAAiBI,GAAjB;AACD;AACF;AAED,aAAO;;AACN;AACJ,GA9CG;AAgDJ;;SACUF;AACR,MAAIF,UAAU,GAACC,KAAM,CAAED,UAAvB;AAAA,MAAuBT,2BAAvB;;MACES,UAAO,SAAU;AAClB;AACD;;MACEC,KAAI;QACF;AACDA;AAAC,aACAG;AACAJ,gBAAO,MAAP,CAAiBI,GAAjB;AACD;AACF;SACC;AACDH;AACD;;MACEV,WAAI;AACJ,QAAIY,wBAAJ;;QACE;AACDA;AAAC,aACAC;AACAJ,gBAAO,MAAP,CAAiBI,GAAjB;AACD;AACD;;QACE,kBAAW;AACXJ,gBAAO,SAAP;AACD;AACD;;QACEA,UAAO,SAAU;AAClB;AACF;AACD;;AACA,MAAIK,KAAJ;;MACE;AACDA;AAAC,WACAD;AACAJ,cAAO,MAAP,CAAiBI,GAAjB;AACD;AACD;;MACEJ,UAAO,SAAU;AAClB;AACD;;AACAA,YAAI,KAAJ,CAAeK,KAAf;;MACEL,UAAO,SAAU;AAClB;AACD;;AACD","names":["Observable","identity","isScheduler","generate","initialStateOrOptions","condition","iterate","resultSelectorOrObservable","scheduler","resultSelector","initialState","arguments","options","undefined","subscriber","state","dispatch","conditionResult","err","value"],"sources":["../../../src/internal/observable/generate.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}